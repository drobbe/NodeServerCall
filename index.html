<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Login</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

</head>
<body>
    <ul id="messages"></ul>

    <!-- <button class="btn btn-success" id="disconnect">Desconectar</button>
    <button class="btn btn-danger" id="connect">Conectar</button> -->

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        var socket = io.connect('http://localhost:3000');

        /* $('#disconnect').click(function(){
            socket.disconnect();
        });

        $('#connect').click(function(){
            //socket.socket.reconnect();
            //socket = io.connect('http://localhost:3000',{'force new connection':true });
            socket = io.connect('http://localhost:3000',{'forceNew':true });
            socket.on('connect', function(msg){
                socket.emit('join', prompt('Usuario'));
            });
        });

        socket.on('connect', function(msg){
            socket.emit('join', prompt('Usuario2'));
        });

        socket.on("disconnect", function(){
            console.log("client disconnected from server");
        }); */

        socket.on('message', function (socket) {
            // socket.name + ' se desconecto del chat.' + socket.id
            $('#messages').append($('<li>').text(socket));
            window.scrollTo(0, document.body.scrollHeight);
        });

        socket.on('disconnect', function () {
            // console.log(socket.name + ' se desconecto del chat.' + socket.id);
            $('#messages').append($('<li>').text(socket));
            window.scrollTo(0, document.body.scrollHeight);
        });
        
        /* socket.on('join', function (name) {
            socket.name = name;
            console.log(socket.name + ' se ha conectado.');
        }); */

        // $(function () {
        //     var socket = io.connect('http://localhost:3000');
        
        //     $('form').submit(function () {
                
        //         var estado = $('#messages').text();
                
        //         if (estado == "Connect"){
        //             estado = "Disconect";
        //             socket.emit('session',estado);
                    
        //             socket.disconnect();
                    
        //         }else{
        //             estado = "Connect";
        //             alert(estado);
        //             socket.emit('session', estado);
        //             socket = io.connect('http://localhost:3000', { 'forceNew': true });
        //             socket.on('connect', function (msg2) {
        //                 socket.emit('join', prompt('Usuario'));
        //             });
        //             /* $('#m').val('');*/
        //         }
        //         return false;
                
        //     });

        //     socket.on('session', function (msg) {
        //         $('#messages').text(msg);
        //         // window.scrollTo(0, document.body.scrollHeight);
        //     });
                        
        //     socket.on('connect', function (msg) {
        //         socket.emit('join', prompt('Usuario:'));
        //     });

        //     socket.on("disconnect", function () {
        //         console.log("cliente desconectado por inactividad");
        //     });
        // });
    </script>

    <!-- <ul id="messages"></ul>
    <form action="">
        <span id="m">SSS</span> <button>Send</button>
    </form>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        $(function () {
            var socket = io();
            $('form').submit(function () {
                socket.emit('chat message', $('#m').text());
                // $('#m').val('');
                return false;
            });
            socket.on('chat message', function (msg) {
                $('#messages').append($('<li>').text(msg));
                window.scrollTo(0, document.body.scrollHeight);
            });
        });
    </script> -->
</body>
</html>